"0","getDEgenes_time <- function(minute) {"
"0","  ddss = list()"
"0","  for (assembly in assemblies) {"
"0","    d = dfs[[assembly]]"
"0","    desc_index = which(names(d)==""description"")"
"0","    d = d[,-desc_index]"
"0","    toks = strsplit(names(d),""\\."")"
"0","    genotype=sapply(toks,function(x){x[[1]]})"
"0","    temperature=sapply(toks,function(x){x[[2]]})"
"0","    time=sapply(toks,function(x){x[[3]]})"
"0","    v = genotype%in%c(""A"",""V"")&time==minute"
"0","    d = d[,v]"
"0","    coldata=data.frame(genotype=factor(genotype[v],levels=c(""V"",""A"")),"
"0","                       temperature=factor(temperature[v], levels = c(""28"",""34""))) "
"0","    row.names(coldata)=names(d)"
"0","    cts = round(as.matrix(d))"
"0","    dds = DESeqDataSetFromMatrix(countData=cts,"
"0","                                 colData=coldata,"
"0","                                  design=~genotype + temperature + genotype:temperature) "
"0","    featureData = data.frame(gene=rownames(cts))"
"0","    mcols(dds) = DataFrame(mcols(dds), featureData)"
"0","    dds = DESeq(dds, minReplicatesForReplace=Inf)"
"0","    ddss[[assembly]]=dds"
"0","  }"
"0","  return(ddss)"
"0","}"
